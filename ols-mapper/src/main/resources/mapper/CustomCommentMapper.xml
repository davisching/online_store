<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pers.dc.ols.mapper.CustomCommentMapper">
    <resultMap id="commentVO" type="pers.dc.ols.pojo.vo.CommentRecordVO">
        <result column="face" property="userFace"/>
        <result column="nickname" property="nickname"/>
        <result column="created_time" property="createdTime"/>
        <result column="content" property="content"/>
        <result column="spec_name" property="specName"/>
    </resultMap>
    <select id="getComments" resultMap="commentVO">
        SELECT
            u.face as userFace,
            u.nickname as nickname,
            c.created_time as createdTime,
            c.content as content,
            c.sepc_name as specName
        FROM items_comments c
                 LEFT JOIN users u
                           ON c.user_id = u.id
        WHERE c.item_id = #{itemId}
          <if test="level != null and level != '' and level != '\'\''">
              AND c.comment_level = #{level}
          </if>
        ORDER BY c.created_time DESC
        <if test="from != null">
            LIMIT #{from}, #{to}
        </if>
    </select>
</mapper>